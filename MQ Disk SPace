What consumes disk space in MQ
1ï¸âƒ£ Queue Manager logs (transaction logs):

MQâ€™s recovery and durability rely on these logs.

Logs grow with persistent messages and transactions.

2ï¸âƒ£ Queue files (persistent messages):

Each queue holding persistent messages stores them on disk until consumed or expired.

Transient/non-persistent messages donâ€™t stay on disk.

3ï¸âƒ£ Configuration data (QMGR config, object definitions).

ğŸ“ Disk space sizing considerations
1ï¸âƒ£ Persistent message volume
Estimate peak queue depth Ã— max message size for your busiest queue(s) to calculate potential disk usage for queue data.

Example: If you expect up to 10,000 messages of 10KB â†’ thatâ€™s ~100MB.

2ï¸âƒ£ Transaction logs
Transaction logs are the biggest disk consumers for high-volume apps using persistent messages.

Disk space required depends on:

Number of log files (LogPrimaryFiles + LogSecondaryFiles) Ã— size of each file (LogFilePages Ã— 4KB/page).

Number and duration of active transactions.

ğŸ” Example:
In qm.ini:

makefile
Copy
Edit
Log:
   LogPrimaryFiles=15
   LogSecondaryFiles=10
   LogFilePages=16384
Each log file: 16384 pages Ã— 4KB = 64MB

Total primary logs: 15 Ã— 64MB = 960MB

Total secondary logs: 10 Ã— 64MB = 640MB

So logs can grow up to ~1.6GB.

3ï¸âƒ£ Queue manager + configuration overhead
Add ~500MBâ€“1GB for queue manager object definitions and other metadata.

âœ… Recommended sizing formula
Minimum disk space â‰ˆ

scss
Copy
Edit
(Max persistent messages Ã— avg size)
+ (total primary + secondary logs)
+ (1GB buffer for QMGR config/metadata)
+ (30â€“50% overhead for growth/spikes)
âœ… Example calculation
If:
âœ… Expect peak of 200,000 messages at 5KB â†’ 1GB queue data.
âœ… Logs: ~2GB (from above example).
âœ… Add 1GB for config.
âœ… Add 50% overhead â†’ ~2GB extra.

Recommended disk space:
1GB + 2GB + 1GB + 2GB overhead = 6GB minimum
Realistically: allocate 10â€“20GB for production queue managers.

âœ… Additional tips for disk setup
âœ… Place MQ data directories (/var/mqm/qmgrs/) and log directories (/var/mqm/log/) on separate disks/partitions if possible â†’ isolates logs from queue data and avoids one filling up the other.
âœ… Use fast disks (SSD/NVMe) for transaction logs â†’ MQâ€™s performance for persistent messages is log-write bound.
âœ… Monitor disk usage proactively â†’ set alerts before reaching 80% utilization.
âœ… Consider log archiving for older logs (if you enable circular logs, they wonâ€™t grow indefinitely; if linear, logs grow until archived).
âœ… In cloud environments â†’ ensure your persistent volume supports IOPS/throughput requirements of your workload.

ğŸ” Commands to check disk usage for MQ
On your MQ server, run:

bash
Copy
Edit
df -h /var/mqm
To check log directory usage:

bash
Copy
Edit
du -sh /var/mqm/log/*
âœ… Key MQ config files
qm.ini: defines log settings.

mqs.ini: system-wide config.

MQ data: /var/mqm/qmgrs/<QMGR_NAME>/

MQ logs: /var/mqm/log/<QMGR_NAME>/

ğŸš¨ Important!
If disk fills up:

MQ stops accepting new persistent messages.

Queue manager may fail or freeze.

Must free disk space or remove messages to resume operation.

ğŸ”¥ TL;DR Recommended disk setup
âœ… For small/medium workloads â†’ 10â€“20GB per queue manager
âœ… For high-throughput systems â†’ plan 30â€“100GB or more depending on persistent message retention and expected queue depths.

Would you like help tuning your qm.ini log settings or setting up disk space monitoring for MQ?
